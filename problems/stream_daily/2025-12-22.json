[
  {
    "problem_id": "stream_active_001",
    "difficulty": "easy",
    "topic": "active_users",
    "requester": "ë°ì´í„°íŒ€ ê¹€ë¯¼ì¤€",
    "question": "ë¯¼ì¤€ì´ì—ìš”! ì˜¤ëŠ˜ ê°‘ìžê¸° DAU ê·¸ëž˜í”„ê°€ í™• ë–¨ì–´ì¡ŒëŠ”ë°ìš” ã… ã…  ìµœê·¼ 7ì¼ ì¼ë³„ DAU ì¶”ì´ ì¢€ ê¸‰í•˜ê²Œ ë½‘ì•„ì£¼ì‹¤ ìˆ˜ ìžˆì–´ìš”? ë­”ê°€ ì´ìƒí•´ì„œìš”...!",
    "context": "DAU = í•´ë‹¹ ë‚ ì§œì— ì´ë²¤íŠ¸ 1ê±´+ ìžˆëŠ” ê³ ìœ  ìœ ì € ìˆ˜",
    "expected_columns": [
      "event_date",
      "dau"
    ],
    "hint": "stream_eventsì—ì„œ event_time ë‚ ì§œ ë³€í™˜ í›„ user_id COUNT DISTINCT",
    "answer_sql": "SELECT DATE(event_time) as event_date, COUNT(DISTINCT user_id) as dau FROM stream_events WHERE event_time >= CURRENT_DATE - INTERVAL '7 days' GROUP BY DATE(event_time) ORDER BY event_date"
  },
  {
    "problem_id": "stream_session_001",
    "difficulty": "easy",
    "topic": "session",
    "requester": "í”„ë¡œë•íŠ¸íŒ€ ì´ì„œì—° PM",
    "question": "ì„œì—°ì´ì—ìš”~ ìœ ì €ë‹¹ í‰ê·  ì„¸ì…˜ ìˆ˜ ê¶ê¸ˆí•œë° í˜¹ì‹œ ê¸ˆë°© ë³¼ ìˆ˜ ìžˆì„ê¹Œìš”? ì°¸ì—¬ë„ ì§€í‘œ ì •ë¦¬ì¤‘ì´ì—ìš”!",
    "context": "ì„¸ì…˜ ìˆ˜ ì¦ê°€ = ì‚¬ìš©ìž ì°¸ì—¬ë„ ì¢‹ì€ ì§€í‘œ",
    "expected_columns": [
      "avg_sessions"
    ],
    "hint": "stream_sessions í…Œì´ë¸” ì‚¬ìš©",
    "answer_sql": "SELECT ROUND(COUNT(*)::numeric / COUNT(DISTINCT user_id), 2) as avg_sessions FROM stream_sessions"
  },
  {
    "problem_id": "stream_event_001",
    "difficulty": "medium",
    "topic": "event_analysis",
    "requester": "ë§ˆì¼€íŒ…íŒ€ ë°•ì§€í˜¸",
    "question": "ì§€í˜¸ì—ìš”! ì´ë²¤íŠ¸ íƒ€ìž…ë³„ ë°œìƒ ê±´ìˆ˜ëž‘ ë¹„ìœ¨ ì¢€ ë´ì•¼í•´ì„œìš”. ì–´ë–¤ ì´ë²¤íŠ¸ê°€ ì œì¼ ë§Žì´ í„°ì§€ëŠ”ì§€ ê¶ê¸ˆí•´ìš” ðŸ“Š ê°€ëŠ¥í•˜ë©´ ì˜¤ëŠ˜ ì¤‘ìœ¼ë¡œ ë¶€íƒë“œë ¤ìš”~",
    "context": "ì´ë²¤íŠ¸ ë¶„í¬ íŒŒì•… â†’ ì‚¬ìš©ìž í–‰ë™ íŒ¨í„´ ì´í•´",
    "expected_columns": [
      "event_name",
      "count",
      "percentage"
    ],
    "hint": "ì „ì²´ ì´ë²¤íŠ¸ ìˆ˜ ëŒ€ë¹„ ê° íƒ€ìž… ë¹„ìœ¨ ê³„ì‚°",
    "answer_sql": "SELECT event_name, COUNT(*) as count, ROUND(COUNT(*)::numeric / SUM(COUNT(*)) OVER () * 100, 2) as percentage FROM stream_events GROUP BY event_name ORDER BY count DESC"
  },
  {
    "problem_id": "stream_funnel_001",
    "difficulty": "medium",
    "topic": "funnel",
    "requester": "ê·¸ë¡œìŠ¤íŒ€ ìµœí˜„ìš°",
    "question": "í˜„ìš°ì—ìš”! view â†’ click â†’ purchase í¼ë„ ë¶„ì„ í•„ìš”í•´ì„œìš”. ë‹¨ê³„ë³„ ìœ ì €ìˆ˜ëž‘ ì „í™˜ìœ¨ ë½‘ì•„ì£¼ì‹¤ ìˆ˜ ìžˆë‚˜ìš”? í¼ë„ ê°œì„  í¬ì¸íŠ¸ ì°¾ì•„ì•¼í•´ìš”!",
    "context": "í¼ë„ ê°œì„  í¬ì¸íŠ¸ ë¶„ì„",
    "expected_columns": [
      "step",
      "users",
      "conversion_rate"
    ],
    "hint": "ê° ì´ë²¤íŠ¸ íƒ€ìž…ë³„ DISTINCT user_id ì¹´ìš´íŠ¸",
    "answer_sql": "WITH funnel AS (SELECT 'view' as step, 1 as step_order, COUNT(DISTINCT user_id) as users FROM stream_events WHERE event_name = 'view' UNION ALL SELECT 'click', 2, COUNT(DISTINCT user_id) FROM stream_events WHERE event_name = 'click' UNION ALL SELECT 'purchase', 3, COUNT(DISTINCT user_id) FROM stream_events WHERE event_name = 'purchase') SELECT step, users, ROUND(users::numeric / FIRST_VALUE(users) OVER (ORDER BY step_order) * 100, 2) as conversion_rate FROM funnel ORDER BY step_order"
  },
  {
    "problem_id": "stream_device_001",
    "difficulty": "medium",
    "topic": "device",
    "requester": "UXíŒ€ ì •ìˆ˜ì•„",
    "question": "ìˆ˜ì•„ì—ìš”~ ë””ë°”ì´ìŠ¤ë³„ ì„¸ì…˜ ìˆ˜ëž‘ í‰ê·  ì´ë²¤íŠ¸ ìˆ˜ ì¢€ ë´ì£¼ì‹¤ ìˆ˜ ìžˆì–´ìš”? ëª¨ë°”ì¼ì´ëž‘ ì›¹ ì‚¬ìš© íŒ¨í„´ ì°¨ì´ ë³´ë ¤êµ¬ìš”!",
    "context": "ë””ë°”ì´ìŠ¤ë³„ ì‚¬ìš© íŒ¨í„´ ë¶„ì„",
    "expected_columns": [
      "device",
      "session_count",
      "avg_events_per_session"
    ],
    "hint": "stream_sessionsì™€ stream_events ì¡°ì¸",
    "answer_sql": "SELECT s.device, COUNT(DISTINCT s.session_id) as session_count, ROUND(COUNT(e.event_id)::numeric / COUNT(DISTINCT s.session_id), 2) as avg_events_per_session FROM stream_sessions s LEFT JOIN stream_events e ON s.session_id = e.session_id GROUP BY s.device ORDER BY session_count DESC"
  },
  {
    "problem_id": "stream_power_001",
    "difficulty": "hard",
    "topic": "power_users",
    "requester": "ì „ëžµê¸°íšíŒ€ í•œë™í›ˆ ì´ì‚¬",
    "question": "ë™í›ˆìž…ë‹ˆë‹¤. íŒŒì›Œìœ ì € ë¶„ì„ ì¢€ ë¶€íƒë“œë ¤ìš”. ìµœê·¼ 30ì¼ê°„ 7ì¼ ì´ìƒ í™œë™í•œ ìœ ì €ë¥¼ íŒŒì›Œìœ ì €ë¡œ ë³´ê³ , ì´ ë¶„ë“¤ í‰ê·  ì„¸ì…˜ìˆ˜, í‰ê·  ì´ë²¤íŠ¸ìˆ˜ ì¢€ ë´ì£¼ì„¸ìš”. íƒ€ê²ŸíŒ… ì „ëžµ ì„¸ì›Œì•¼í•´ì„œìš”.",
    "context": "íŒŒì›Œ ìœ ì € íƒ€ê²Ÿ ë§ˆì¼€íŒ… ì „ëžµ ìˆ˜ë¦½",
    "expected_columns": [
      "power_user_count",
      "avg_active_days",
      "avg_sessions",
      "avg_events"
    ],
    "hint": "30ì¼ ë‚´ 7ì¼+ í™œë™ ìœ ì € êµ¬í•œ í›„ ì§‘ê³„",
    "answer_sql": "WITH user_activity AS (SELECT user_id, COUNT(DISTINCT DATE(event_time)) as active_days, COUNT(DISTINCT session_id) as sessions, COUNT(*) as events FROM stream_events WHERE event_time >= CURRENT_DATE - INTERVAL '30 days' GROUP BY user_id HAVING COUNT(DISTINCT DATE(event_time)) >= 7) SELECT COUNT(*) as power_user_count, ROUND(AVG(active_days), 1) as avg_active_days, ROUND(AVG(sessions), 1) as avg_sessions, ROUND(AVG(events), 1) as avg_events FROM user_activity"
  }
]